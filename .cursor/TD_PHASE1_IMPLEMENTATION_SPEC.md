# Phase TD-1: TDã‚²ãƒ¼ãƒ  Webã‚¨ãƒ‡ã‚£ã‚¿çµ±åˆ - å®Ÿè£…ä»•æ§˜æ›¸

**ãƒãƒ¼ã‚¸ãƒ§ãƒ³**: 1.0  
**ä½œæˆæ—¥**: 2025å¹´12æœˆ4æ—¥  
**ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹**: ğŸ“ ãƒ¬ãƒ“ãƒ¥ãƒ¼å¾…ã¡  
**ç›®çš„**: Webã‚¨ãƒ‡ã‚£ã‚¿ã‹ã‚‰ TDã‚²ãƒ¼ãƒ ã‚’ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ ã§é–‹ç™ºãƒ»åˆ¶å¾¡

---

## ğŸ“Œ æ¦‚è¦

çµ±åˆãƒ—ãƒ©ãƒƒãƒˆãƒ•ã‚©ãƒ¼ãƒ ä¸Šã§å‹•ä½œã™ã‚‹TDã‚²ãƒ¼ãƒ ã‚’Webã‚¨ãƒ‡ã‚£ã‚¿ã‹ã‚‰å®Œå…¨ã«åˆ¶å¾¡ãƒ»é–‹ç™ºã§ãã‚‹ã‚ˆã†ã«ã™ã‚‹ã€‚  
JSONã‚¹ãƒ†ãƒ¼ã‚¸å®šç¾©ã®ç·¨é›†ã€æ•µãƒ¦ãƒ‹ãƒƒãƒˆã®ã‚¹ãƒãƒ¼ãƒ³ã€ã‚²ãƒ¼ãƒ çŠ¶æ…‹ã®æ“ä½œã‚’å…¨ã¦WebUIã§å®Ÿæ–½ã€‚

---

## ğŸ—ï¸ ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£è¨­è¨ˆ

### ã‚·ã‚¹ãƒ†ãƒ æ§‹æˆå›³

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Webã‚¨ãƒ‡ã‚£ã‚¿ (React/TypeScript)                              â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”              â”‚
â”‚ â”‚ TDController â”‚ TDEntityUI   â”‚ TDGameState  â”‚              â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜              â”‚
â”‚        â”‚              â”‚              â”‚                       â”‚
â”‚        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                       â”‚
â”‚                       â†“                                      â”‚
â”‚          ApiClient (HTTP/WebSocket)                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                        â†“ HTTP API
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ HTTPServer (C++)                                            â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚ â”‚ TD Routes (/api/td/*)                                â”‚   â”‚
â”‚ â”‚  - GET  /api/td/entities                             â”‚   â”‚
â”‚ â”‚  - GET  /api/td/gamestate                            â”‚   â”‚
â”‚ â”‚  - POST /api/td/spawn                                â”‚   â”‚
â”‚ â”‚  - POST /api/td/wave/next                            â”‚   â”‚
â”‚ â”‚  - POST /api/td/gamestate/hp                         â”‚   â”‚
â”‚ â”‚  - POST /api/td/gamestate/gold                       â”‚   â”‚
â”‚ â”‚  - POST /api/td/reset                                â”‚   â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                        â†“ (GameContext çµŒç”±)
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ UnifiedGame (C++)                                           â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚ â”‚ TDGameScene                                          â”‚   â”‚
â”‚ â”‚  - ã‚²ãƒ¼ãƒ çŠ¶æ…‹ç®¡ç†                                     â”‚   â”‚
â”‚ â”‚  - ã‚¨ãƒ³ãƒ†ã‚£ãƒ†ã‚£ç®¡ç†                                   â”‚   â”‚
â”‚ â”‚  - Waveç®¡ç†                                          â”‚   â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ”Œ API ä»•æ§˜

### 1. ã‚¨ãƒ³ãƒ†ã‚£ãƒ†ã‚£å–å¾—

#### GET `/api/td/entities`

**èª¬æ˜**: TDã‚²ãƒ¼ãƒ å†…ã®å…¨ã‚¨ãƒ³ãƒ†ã‚£ãƒ†ã‚£å–å¾—ï¼ˆæ•µãƒ»å‘³æ–¹ä¸¡æ–¹ï¼‰

**ãƒ¬ã‚¹ãƒãƒ³ã‚¹** (200 OK):
```json
{
  "success": true,
  "count": 5,
  "entities": [
    {
      "id": "enemy_1",
      "type": "enemy",
      "name": "Goblin",
      "position": { "x": 10.5, "y": 20.3 },
      "stats": {
        "hp": 100,
        "max_hp": 100,
        "attack_power": 10,
        "defense": 5,
        "speed": 2.0
      },
      "wave": 1,
      "status": "alive"
    },
    {
      "id": "tower_1",
      "type": "tower",
      "name": "Archer Tower",
      "position": { "x": 5.0, "y": 15.0 },
      "stats": {
        "hp": 150,
        "max_hp": 150,
        "attack_power": 25,
        "range": 50,
        "attack_cooldown": 1.5
      },
      "level": 1,
      "status": "active"
    }
  ]
}
```

**ã‚¨ãƒ©ãƒ¼ãƒ¬ã‚¹ãƒãƒ³ã‚¹** (503 Service Unavailable):
```json
{
  "error": true,
  "status": 503,
  "message": "Entity operations not available",
  "details": "Entity operation callbacks not set"
}
```

---

### 2. ã‚²ãƒ¼ãƒ çŠ¶æ…‹å–å¾—

#### GET `/api/td/gamestate`

**èª¬æ˜**: TDã‚²ãƒ¼ãƒ ã®ç¾åœ¨çŠ¶æ…‹ã‚’å–å¾—

**ãƒ¬ã‚¹ãƒãƒ³ã‚¹** (200 OK):
```json
{
  "success": true,
  "gameState": {
    "phase": "Playing",
    "current_wave": 1,
    "total_waves": 10,
    "base_hp": 100,
    "base_max_hp": 100,
    "gold": 500,
    "gold_per_kill": 50,
    "time_elapsed": 123.45,
    "is_paused": false,
    "wave_in_progress": true
  },
  "entities_summary": {
    "enemy_count": 5,
    "tower_count": 3,
    "projectile_count": 0
  },
  "performance": {
    "fps": 60,
    "frame_time_ms": 16.67
  }
}
```

---

### 3. ãƒ¦ãƒ‹ãƒƒãƒˆã‚¹ãƒãƒ¼ãƒ³

#### POST `/api/td/spawn`

**èª¬æ˜**: æ•µã¾ãŸã¯å‘³æ–¹ãƒ¦ãƒ‹ãƒƒãƒˆã‚’ã‚²ãƒ¼ãƒ å†…ã«å³åº§ã«ã‚¹ãƒãƒ¼ãƒ³

**ãƒªã‚¯ã‚¨ã‚¹ãƒˆãƒœãƒ‡ã‚£**:
```json
{
  "type": "enemy",
  "entity_name": "Goblin",
  "position": {
    "x": 10.0,
    "y": 15.0
  },
  "stats": {
    "hp": 100,
    "max_hp": 100,
    "attack_power": 10,
    "defense": 5,
    "speed": 2.0
  },
  "wave": 1,
  "count": 1
}
```

**ãƒ¬ã‚¹ãƒãƒ³ã‚¹** (201 Created):
```json
{
  "success": true,
  "message": "Entity spawned successfully",
  "spawned_entities": [
    {
      "id": "enemy_42",
      "type": "enemy",
      "name": "Goblin",
      "position": { "x": 10.0, "y": 15.0 }
    }
  ]
}
```

**ã‚¨ãƒ©ãƒ¼** (400 Bad Request):
```json
{
  "error": true,
  "status": 400,
  "message": "Invalid spawn parameters",
  "details": "Missing required field: type"
}
```

---

### 4. Waveé€²è¡Œåˆ¶å¾¡

#### POST `/api/td/wave/next`

**èª¬æ˜**: æ¬¡ã®Waveã«é€²è¡Œ

**ãƒªã‚¯ã‚¨ã‚¹ãƒˆãƒœãƒ‡ã‚£** (ã‚ªãƒ—ã‚·ãƒ§ãƒ³):
```json
{
  "skip_delay": true,
  "spawn_all_enemies": true
}
```

**ãƒ¬ã‚¹ãƒãƒ³ã‚¹** (200 OK):
```json
{
  "success": true,
  "message": "Progressed to next wave",
  "new_wave": 2,
  "total_waves": 10,
  "enemies_spawned": 8
}
```

---

### 5. HPè¨­å®š

#### POST `/api/td/gamestate/hp`

**èª¬æ˜**: ãƒ™ãƒ¼ã‚¹HP ã‚’è¨­å®šï¼ˆãƒ‡ãƒãƒƒã‚°ç”¨ï¼‰

**ãƒªã‚¯ã‚¨ã‚¹ãƒˆãƒœãƒ‡ã‚£**:
```json
{
  "value": 50,
  "mode": "set"  // "set", "add", "subtract"
}
```

**ãƒ¬ã‚¹ãƒãƒ³ã‚¹** (200 OK):
```json
{
  "success": true,
  "message": "Base HP updated",
  "old_hp": 100,
  "new_hp": 50,
  "max_hp": 100,
  "game_over": false
}
```

---

### 6. é‡‘è¨­å®š

#### POST `/api/td/gamestate/gold`

**èª¬æ˜**: ã‚²ãƒ¼ãƒ å†…ã®é‡‘ã‚’è¨­å®šï¼ˆãƒ‡ãƒãƒƒã‚°ç”¨ï¼‰

**ãƒªã‚¯ã‚¨ã‚¹ãƒˆãƒœãƒ‡ã‚£**:
```json
{
  "value": 1000,
  "mode": "set"  // "set", "add", "subtract"
}
```

**ãƒ¬ã‚¹ãƒãƒ³ã‚¹** (200 OK):
```json
{
  "success": true,
  "message": "Gold updated",
  "old_gold": 500,
  "new_gold": 1000
}
```

---

### 7. ã‚²ãƒ¼ãƒ ãƒªã‚»ãƒƒãƒˆ

#### POST `/api/td/reset`

**èª¬æ˜**: TDã‚²ãƒ¼ãƒ çŠ¶æ…‹ã‚’åˆæœŸçŠ¶æ…‹ã«ãƒªã‚»ãƒƒãƒˆ

**ãƒªã‚¯ã‚¨ã‚¹ãƒˆãƒœãƒ‡ã‚£** (ã‚ªãƒ—ã‚·ãƒ§ãƒ³):
```json
{
  "stage_name": "stage_1",
  "keep_definitions": false
}
```

**ãƒ¬ã‚¹ãƒãƒ³ã‚¹** (200 OK):
```json
{
  "success": true,
  "message": "Game reset successfully",
  "stage": "stage_1",
  "wave": 1,
  "base_hp": 100,
  "gold": 500
}
```

---

## ğŸ¨ React ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆä»•æ§˜

### ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªæ§‹é€ 

```
tools/webui-editor/src/components/DevTools/TD/
â”œâ”€â”€ index.ts                    # ã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆ
â”œâ”€â”€ TDController.tsx            # ãƒ¡ã‚¤ãƒ³ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ
â”œâ”€â”€ TDEntitySpawner.tsx         # ãƒ¦ãƒ‹ãƒƒãƒˆç”ŸæˆUI
â”œâ”€â”€ TDGameStatePanel.tsx        # ã‚²ãƒ¼ãƒ çŠ¶æ…‹è¡¨ç¤ºãƒ»æ“ä½œ
â”œâ”€â”€ TDStatusMonitor.tsx         # ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ çŠ¶æ…‹ç›£è¦–
â””â”€â”€ hooks/
    â””â”€â”€ useTDGameState.ts       # ã‚«ã‚¹ã‚¿ãƒ ãƒ•ãƒƒã‚¯
```

---

### 1. TDController.tsx

**ç”¨é€”**: TDé–‹ç™ºã®çµ±åˆãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰

**æ©Ÿèƒ½**:
- ğŸ® ã‚²ãƒ¼ãƒ æ“ä½œãƒœã‚¿ãƒ³ï¼ˆé–‹å§‹ãƒ»åœæ­¢ãƒ»ãƒªã‚»ãƒƒãƒˆï¼‰
- ğŸ“Š ã‚²ãƒ¼ãƒ çŠ¶æ…‹è¡¨ç¤ºï¼ˆWaveã€HPã€é‡‘ï¼‰
- ğŸ¯ ãƒ¦ãƒ‹ãƒƒãƒˆä¸€è¦§è¡¨ç¤º
- âš™ï¸ ãƒ‡ãƒãƒƒã‚°ãƒ‘ãƒãƒ«

**Props**:
```typescript
interface TDControllerProps {
  gameRunning?: boolean;
  onStatusChange?: (status: 'running' | 'paused' | 'stopped') => void;
}
```

**çŠ¶æ…‹ç®¡ç†**:
```typescript
const [gameState, setGameState] = useState(null);
const [entities, setEntities] = useState([]);
const [loading, setLoading] = useState(false);
const [autoRefresh, setAutoRefresh] = useState(true);
```

**UI ãƒ¬ã‚¤ã‚¢ã‚¦ãƒˆ**:
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ TDã‚³ãƒ³ãƒˆãƒ­ãƒ¼ãƒ©ãƒ¼                           â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ [â–¶é–‹å§‹] [â¸åœæ­¢] [ğŸ”„ãƒªã‚»ãƒƒãƒˆ]             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Wave: 1/10  |  HP: 100/100  |  é‡‘: 500   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ â”Œâ”€ ãƒ¦ãƒ‹ãƒƒãƒˆä¸€è¦§ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚ â”‚ æ•µ: 5åŒ¹  |  å¡”: 3å€‹  |  å°„å¼¾: 0å€‹     â”‚ â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚ â”Œâ”€ ãƒ‡ãƒãƒƒã‚° â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚ â”‚ [æ•µã‚¹ãƒãƒ¼ãƒ³] [Waveæ¬¡ã¸]             â”‚ â”‚
â”‚ â”‚ HPè¨­å®š: [____] é‡‘è¨­å®š: [____]       â”‚ â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

### 2. TDEntitySpawner.tsx

**ç”¨é€”**: ãƒ¦ãƒ‹ãƒƒãƒˆç”ŸæˆUI

**æ©Ÿèƒ½**:
- æ•µãƒ¦ãƒ‹ãƒƒãƒˆãƒ—ãƒªã‚»ãƒƒãƒˆï¼ˆGoblinã€Orcç­‰ï¼‰
- å‘³æ–¹å¡”ãƒ—ãƒªã‚»ãƒƒãƒˆï¼ˆArcher Towerã€Fire Towerç­‰ï¼‰
- ã‚«ã‚¹ã‚¿ãƒ ãƒ¦ãƒ‹ãƒƒãƒˆç”Ÿæˆ
- è¤‡æ•°ã‚¹ãƒãƒ¼ãƒ³

**Props**:
```typescript
interface TDEntitySpawnerProps {
  onSpawn?: (entity: SpawnRequest) => void;
  presets?: EntityPreset[];
}
```

**UI**:
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ãƒ¦ãƒ‹ãƒƒãƒˆã‚¹ãƒãƒ¼ãƒŠãƒ¼                     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ æ•µã‚¿ã‚¤ãƒ—: [Goblin â–¼]                  â”‚
â”‚ å€‹æ•°: [1] [+] [-]                     â”‚
â”‚ ä½ç½®: X[10.0] Y[15.0]                 â”‚
â”‚ [ã‚¹ãƒãƒ¼ãƒ³]                             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ å¡”ã‚¿ã‚¤ãƒ—: [Archer Tower â–¼]            â”‚
â”‚ ãƒ¬ãƒ™ãƒ«: [1]                           â”‚
â”‚ ä½ç½®: X[100.0] Y[200.0]               â”‚
â”‚ [é…ç½®]                                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

### 3. TDGameStatePanel.tsx

**ç”¨é€”**: ã‚²ãƒ¼ãƒ çŠ¶æ…‹è¡¨ç¤ºãƒ»æ“ä½œ

**æ©Ÿèƒ½**:
- ç¾åœ¨ã®Waveè¡¨ç¤º
- HP/é‡‘è¡¨ç¤ºã¨ç›´æ¥æ“ä½œ
- ã‚²ãƒ¼ãƒ çŠ¶æ…‹ï¼ˆå®Ÿè¡Œä¸­ãƒ»ä¸€æ™‚åœæ­¢ãƒ»åœæ­¢ï¼‰è¡¨ç¤º
- ãƒ•ãƒ¬ãƒ¼ãƒ ãƒ¬ãƒ¼ãƒˆãƒ»ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹è¡¨ç¤º

**Props**:
```typescript
interface TDGameStatePanelProps {
  state?: GameState;
  onHPChange?: (newHP: number) => void;
  onGoldChange?: (newGold: number) => void;
}
```

**UI**:
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ã‚²ãƒ¼ãƒ çŠ¶æ…‹                         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Wave: 1/10  [æ¬¡ã¸ >]             â”‚
â”‚ HP: [====100/100==] [Edit]       â”‚
â”‚ é‡‘: [========500====] [Edit]      â”‚
â”‚ çŠ¶æ…‹: â–¶ å®Ÿè¡Œä¸­                    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ FPS: 60  |  Frame: 16.67ms       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

### 4. TDStatusMonitor.tsx

**ç”¨é€”**: ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ çŠ¶æ…‹ç›£è¦–

**æ©Ÿèƒ½**:
- ã‚¨ãƒ³ãƒ†ã‚£ãƒ†ã‚£æ•°ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ æ›´æ–°
- ã‚²ãƒ¼ãƒ  ã‚¤ãƒ™ãƒ³ãƒˆè¡¨ç¤º
- ãƒ‡ãƒãƒƒã‚°ãƒ­ã‚°è¡¨ç¤º
- è‡ªå‹•ãƒªãƒ•ãƒ¬ãƒƒã‚·ãƒ¥ï¼ˆ1ç§’ã”ã¨ï¼‰

**Props**:
```typescript
interface TDStatusMonitorProps {
  autoRefresh?: boolean;
  refreshInterval?: number;  // ãƒŸãƒªç§’
}
```

**UI**:
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ ãƒ¢ãƒ‹ã‚¿ãƒ¼           â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ æ•µæ•°: 5  |  å¡”æ•°: 3          â”‚
â”‚ å°„å¼¾: 0  |  ãƒ‘ãƒ¼ãƒ†ã‚£ã‚¯ãƒ«: 12  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ ã‚¤ãƒ™ãƒ³ãƒˆãƒ­ã‚°                  â”‚
â”‚ 13:45:23 Wave 1 é–‹å§‹          â”‚
â”‚ 13:45:30 æ•µå€’ã—ãŸ +50é‡‘       â”‚
â”‚ 13:45:35 æ•µãŒå¡”ã‚’æ”»æ’ƒ         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

### 5. useTDGameState.ts (Custom Hook)

**ç”¨é€”**: ã‚²ãƒ¼ãƒ çŠ¶æ…‹ç®¡ç†ã®å…±é€šãƒ­ã‚¸ãƒƒã‚¯

**å®Ÿè£…**:
```typescript
interface UseTDGameStateReturn {
  gameState: GameState | null;
  entities: Entity[];
  loading: boolean;
  error: string | null;
  
  // ãƒ¡ã‚½ãƒƒãƒ‰
  refreshGameState: () => Promise<void>;
  spawnEntity: (request: SpawnRequest) => Promise<void>;
  setHP: (value: number) => Promise<void>;
  setGold: (value: number) => Promise<void>;
  nextWave: () => Promise<void>;
  resetGame: () => Promise<void>;
}

function useTDGameState(autoRefresh?: boolean): UseTDGameStateReturn {
  // å®Ÿè£…
}
```

---

## ğŸ”§ C++å®Ÿè£…ä»•æ§˜

### UnifiedGame æ‹¡å¼µ

**ãƒ•ã‚¡ã‚¤ãƒ«**: `include/Application/UnifiedGame.h` + `src/Application/UnifiedGame.cpp`

**æ–°è¦ãƒ¡ã‚½ãƒƒãƒ‰**:

```cpp
public:
    // TDå°‚ç”¨ã‚²ãƒƒã‚¿ãƒ¼
    nlohmann::json GetTDEntities();
    nlohmann::json GetTDGameState();
    
    // TDå°‚ç”¨ã‚»ãƒƒã‚¿ãƒ¼
    bool SpawnTDEntity(const nlohmann::json& entityDef);
    bool SetTDHP(float value, const std::string& mode = "set");
    bool SetTDGold(int value, const std::string& mode = "set");
    bool NextTDWave();
    bool ResetTDGame();
    
private:
    // TDGameScene ã¸ã®ã‚¢ã‚¯ã‚»ã‚¹
    class TDGameScene* GetTDGameScene();
```

**å®Ÿè£…å†…å®¹**:
1. currentScene_ ã‹ã‚‰ TDGameScene ã‚’å–å¾—
2. ã‚²ãƒ¼ãƒ çŠ¶æ…‹ã‚’JSONå½¢å¼ã§å–å¾—ãƒ»è¨­å®š
3. ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°ï¼ˆnullãƒã‚§ãƒƒã‚¯ç­‰ï¼‰

---

### HTTPServer æ‹¡å¼µ

**ãƒ•ã‚¡ã‚¤ãƒ«**: `src/Core/HTTPServer.cpp`

**SetupTDRoutes() ãƒ¡ã‚½ãƒƒãƒ‰è¿½åŠ **:

```cpp
void HTTPServer::SetupTDRoutes() {
    // GET /api/td/entities
    impl_->server->Get("/api/td/entities", 
        [this](const httplib::Request&, httplib::Response& res) {
            // å®Ÿè£…
        });
    
    // GET /api/td/gamestate
    // POST /api/td/spawn
    // POST /api/td/wave/next
    // POST /api/td/gamestate/hp
    // POST /api/td/gamestate/gold
    // POST /api/td/reset
}
```

**SetupRoutes() ã§å‘¼ã³å‡ºã—è¿½åŠ **:
```cpp
void HTTPServer::SetupRoutes() {
    // ...
    SetupDevModeRoutes();
    SetupTDRoutes();  // â† è¿½åŠ 
}
```

---

## ğŸ§ª ãƒ†ã‚¹ãƒˆä»•æ§˜

### å˜ä½“ãƒ†ã‚¹ãƒˆ

**C++ å´**:
- [ ] UnifiedGame::GetTDEntities() - JSONå½¢å¼ã§è¿”ã•ã‚Œã‚‹ã‹
- [ ] UnifiedGame::GetTDGameState() - æ­£ç¢ºãªæƒ…å ±ã‹
- [ ] UnifiedGame::SetTDHP() - å€¤ãŒæ­£ã—ãåæ˜ ã•ã‚Œã‚‹ã‹
- [ ] HTTPServer ãƒ«ãƒ¼ãƒˆ - æ­£ã—ã„ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ã‚³ãƒ¼ãƒ‰è¿”å´

**React å´**:
- [ ] APIå‘¼ã³å‡ºã—æˆåŠŸ - 200/201 ãƒ¬ã‚¹ãƒãƒ³ã‚¹
- [ ] çŠ¶æ…‹æ›´æ–° - UI ã«åæ˜ ã•ã‚Œã‚‹ã‹
- [ ] ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚° - 400/500 æ™‚ã®å‡¦ç†

### çµ±åˆãƒ†ã‚¹ãƒˆ

1. **åŸºæœ¬æ“ä½œ**
   - Webã‹ã‚‰æ•µã‚¹ãƒãƒ¼ãƒ³ â†’ ã‚²ãƒ¼ãƒ ç”»é¢ã«è¡¨ç¤ºã•ã‚Œã‚‹
   - Webã‹ã‚‰ã‚¬å†åº¦è¡¨ç¤ºã‚²ãƒ¼ãƒ çŠ¶æ…‹å–å¾— â†’ æ­£ç¢ºãªæƒ…å ±ãŒè¡¨ç¤º
   - Web ã‹ã‚‰ HPè¨­å®š â†’ ã‚²ãƒ¼ãƒ å†…ã§åæ˜ 

2. **ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ æ›´æ–°**
   - æ•µå€’ã—ãŸã‚‰é‡‘ãŒå¢—ãˆã‚‹ â†’ Web ã«ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ åæ˜ 
   - Waveé€²è¡Œ â†’ Web ã«è¡¨ç¤ºæ›´æ–°

3. **ãƒ‡ãƒãƒƒã‚°ã‚·ãƒŠãƒªã‚ª**
   - æ•µå¤§é‡ç”Ÿæˆãƒ†ã‚¹ãƒˆ
   - ã‚²ãƒ¼ãƒ çŠ¶æ…‹å¼·åˆ¶å¤‰æ›´ãƒ†ã‚¹ãƒˆ
   - ãƒªã‚»ãƒƒãƒˆæ©Ÿèƒ½ãƒ†ã‚¹ãƒˆ

---

## ğŸ“¦ ãƒ‡ãƒªãƒãƒªãƒ¼å†…å®¹

### ãƒ•ã‚¡ã‚¤ãƒ«å¤‰æ›´

**ä¿®æ­£ãƒ•ã‚¡ã‚¤ãƒ«** (4å€‹):
1. `include/Application/UnifiedGame.h` - ãƒ¡ã‚½ãƒƒãƒ‰å®£è¨€è¿½åŠ 
2. `src/Application/UnifiedGame.cpp` - ãƒ¡ã‚½ãƒƒãƒ‰å®Ÿè£…
3. `src/Core/HTTPServer.cpp` - ãƒ«ãƒ¼ãƒˆå®Ÿè£…
4. `src/Application/TDGameScene.h` - public ãƒ¡ãƒ³ãƒãƒ¼å…¬é–‹

**æ–°è¦ãƒ•ã‚¡ã‚¤ãƒ«** (6å€‹):
1. `tools/webui-editor/src/components/DevTools/TD/TDController.tsx`
2. `tools/webui-editor/src/components/DevTools/TD/TDEntitySpawner.tsx`
3. `tools/webui-editor/src/components/DevTools/TD/TDGameStatePanel.tsx`
4. `tools/webui-editor/src/components/DevTools/TD/TDStatusMonitor.tsx`
5. `tools/webui-editor/src/components/DevTools/TD/hooks/useTDGameState.ts`
6. `tools/webui-editor/src/components/DevTools/TD/index.ts`

---

## âœ… å®Œäº†åˆ¤å®šåŸºæº–

**C++å´**:
- [ ] ã‚³ãƒ³ãƒ‘ã‚¤ãƒ«æˆåŠŸï¼ˆ0ã‚¨ãƒ©ãƒ¼ï¼‰
- [ ] HTTPã‚µãƒ¼ãƒãƒ¼èµ·å‹•å¯èƒ½
- [ ] å„APIã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆå¿œç­”

**Reactå´**:
- [ ] ã‚³ãƒ³ãƒ‘ã‚¤ãƒ«æˆåŠŸï¼ˆ0ã‚¨ãƒ©ãƒ¼ï¼‰
- [ ] ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆæç”»ç¢ºèª
- [ ] APIå‘¼ã³å‡ºã—æˆåŠŸ

**çµ±åˆ**:
- [ ] Web ã‹ã‚‰æ•µã‚¹ãƒãƒ¼ãƒ³å¯èƒ½
- [ ] Web ã‹ã‚‰çŠ¶æ…‹å¤‰æ›´å¯èƒ½
- [ ] ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ æ›´æ–°å‹•ä½œ

---

## ğŸ“ æ³¨è¨˜

### ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£æ³¨æ„
- æœ¬ä»•æ§˜æ›¸ã¯é–‹ç™ºè€…ãƒ¢ãƒ¼ãƒ‰ï¼ˆlocalhostï¼‰ã®ã¿æƒ³å®š
- æœ¬ç•ªç’°å¢ƒã§ã¯APIã«èªè¨¼è¿½åŠ å¿…é ˆ

### ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹è€ƒæ…®
- APIãƒ¬ã‚¹ãƒãƒ³ã‚¹ã¯ 100ms ä»¥ä¸‹ã‚’ç›®æ¨™
- WebSocketå¯¾å¿œã¯ Phase TD-2 ã§å®Ÿè£…äºˆå®š
- ç¾æ®µéšã§ã¯ HTTP ãƒãƒ¼ãƒªãƒ³ã‚°ã§å¯¾å¿œ

### ä»Šå¾Œã®æ‹¡å¼µ
- Phase TD-2: WebSocket ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ åŒæœŸ
- Phase TD-3: ã‚¹ãƒ†ãƒ¼ã‚¸å®šç¾©ã‚¨ãƒ‡ã‚£ã‚¿çµ±åˆ
- Phase TD-4: ãƒ¦ãƒ‹ãƒƒãƒˆãƒ—ãƒªã‚»ãƒƒãƒˆç®¡ç†

---

**ä»•æ§˜æ›¸ä½œæˆæ—¥**: 2025å¹´12æœˆ4æ—¥  
**ç‰ˆç®¡ç†**: v1.0  
**ãƒ¬ãƒ“ãƒ¥ãƒ¼çŠ¶æ…‹**: â³ å¾…æ©Ÿä¸­  
**æ¨å¥¨ãƒ¬ãƒ“ãƒ¥ãƒ¼è€…**: ã‚ˆã‚ŠçµŒé¨“è±Šå¯ŒãªAI, æŠ€è¡“ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒˆ

